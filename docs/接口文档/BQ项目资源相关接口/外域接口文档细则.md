#### 1.查本域以及外域信息

##### http调平台

###### URL

 ip:8082/tetris-resource/api/thirdpart/monitor_relation/query/server/node/info

###### 返回值

```json
{
    status:200以及其他,
    message:'异常信息',
    data:{
        local:{
            name:"本域名称"，
        },
        foreign:[{
            name:"外域名称",
            password:"口令",
            ip:'',
          	port:'',
            operate:"状态：取值：ON（连接）、OFF（断开)",
            extraInfo:{ "key" :"value"}
        }]
    }
}
```



#### 2.本域信息修改（改名）

##### 平台发passby

###### 参数

```json
{
	layer_id: "层节点id",
	pass_by_content: {
		newName: "",
		oldName: "",
		cmd: "localServerNodeNameChange"
	},
}
```



#### 3.添加外域信息

##### 平台发送passby

###### 参数

```json
{
	layer_id: " ",
	pass_by_content: {
		cmd: "foreignAdd",
		local: {
			nodeName: "本域名称"
		},
		foreign: [{
			password: " ",
			operate: "ON",
			port: " ",
			ip: " ",
			name: "外域名称",
            extraInfo:{ "key" :"value"}
		}]
	}
}

```

#### 4.修改外域信息

##### 平台发送passby

###### 参数

```json
{
	layer_id: "层节点id",
	pass_by_content: {
		cmd: "foreignEdit",
		local: {
			name: " 本域名称"
		},
		foreign: [{
			password: " ",
			newName: " ",
			operate: " ",
			port: " ",
			oldName: " ",
			ip: " ",
            extraInfo:{ "key" :"value"}
		}]
	}
}
```



## 断开外域

#### 5.断开外域连接

##### 平台发送passby

###### 参数

```json
{
	layer_id: "层节点id",
	pass_by_content: {
		cmd: "foreignOff",
		local: {
			name: "本域名称"
		},
		foreign: [{
			operate: "OFF",
			name: "外域名称"
		}]
	}
}
```



#### 6.外域连接断开通知（批量）

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/foreign/server/node/off

###### 参数

```json
{
	foreign: [{
		name: " 外域名称" <--此处应为上一接口的本域名称-->
	}]
}
```



## 连接外域

#### 7.连接外域

##### 平台发送passby

###### 参数

```json
{
	layer_id: " ",
	pass_by_content: {
		cmd: "foreignOn",
		local: {
			name: " 本域名称"
		},
		foreign: [{
			operate: "ON",
			name: " 外域名称"
		}]
	}
}
```



#### 8.连接外域通知

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/foreign/server/node/on

###### 参数

```json
{

	foreign: [{
			operate: "ON",
			name: " 外域名称" <--此处应为上一接口的本域名称-->
			}]

}
```



## 同步信息

#### 9.查询外域下的组织机构和设备信息

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/foreign/server/information

###### 参数

```json
{
    foreign:'外域名称'
}
```



###### 返回值

```json
{
	foreign: [{

        name: "外域名称",

		institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
		}],
		privileges: [" "],<!--权限信息-->
		devices: [{<!--设备信息（同BundleVO）-->
			accessNodeUid: "",  //接入层UID
			bundleAlias: "",    //设备别名
			bundleFolderId: "",//组织机构id
			bundleId: " ",
			bundleName: "",    //设备名称
			bundleType: "",    //设备类型
			channels: [{<!--通道信息-->
				bundleId: "",
				channelId: "",
				channelName: "",
				channelStatus: "",
				channelTemplateID: //通道模板id,
				deviceModel: " "  //设备类型
			}],
			coderType: "ENCODER",  //编解码类型
			deviceAddr: {   //设备ip和地址
    			deviceIp: "",
				devicePort: 
			},
			deviceModel: " ",  //设备类型
			equipFactInfo: "域名称",
			folderId: 162,
			id: 54593,
			institution: "", //组织机构的uuid
			latitude: "",  //坐标-纬度
			location: " ", //地点
			lockStatus: "IDLE", //锁定状态
			longitude: "",  //坐标-经度
			multicastDecode: false,   //是否开启组播解码
			multicastEncode: false,   //是否开启组播编码
			multicastEncodeAddr: "",  //组播编码地址
			multicastSourceIp: "",    //组播源ip
			onlinePassword: "",       //认证密码
			onlineStatus: "ONLINE",   //在线状态
			sourceType: "SYSTEM",     //来源
			status: "ONLINE",         //在线状态
			streamUrl: "",            //流地址
			transcod: false,          //是否转码
			username: "2231231"       //设备账号
		}]
		extraInfo: [{<!--扩展参数-->
			bundleId: " ",
			name: " ",
			value: " "
		}]
	}]
}
```



#### 10.同步外域下的设备组织机构

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/foreign/server/node/message

###### 参数

```json
{
	foreign: [{

        name: "外域名称", 

		institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
		}],
		privileges: [" "],<!--权限信息-->
		devices: [{<!--设备信息（同BundleVO）-->
			accessNodeUid: "",  //接入层UID
			bundleAlias: "",    //设备别名
			bundleFolderId: "",//组织机构id
			bundleId: " ",
			bundleName: "",    //设备名称
			bundleType: "",    //设备类型
			channels: [{<!--通道信息-->
				bundleId: "",
				channelId: "",
				channelName: "",
				channelStatus: "",
				channelTemplateID: //通道模板id,
				deviceModel: " "  //设备类型
			}],
			coderType: "ENCODER",  //编解码类型
			deviceAddr: {   //设备ip和地址
    			deviceIp: "",
				devicePort: 
			},
			deviceModel: " ",  //设备类型
			equipFactInfo: "域名称",
			folderId: 162,
			id: 54593,
			institution: "", //组织机构的uuid
			latitude: "",  //坐标-纬度
			location: " ", //地点
			lockStatus: "IDLE", //锁定状态
			longitude: "",  //坐标-经度
			multicastDecode: false,   //是否开启组播解码
			multicastEncode: false,   //是否开启组播编码
			multicastEncodeAddr: "",  //组播编码地址
			multicastSourceIp: "",    //组播源ip
			onlinePassword: "",       //认证密码
			onlineStatus: "ONLINE",   //在线状态
			sourceType: "SYSTEM",     //来源
			status: "ONLINE",         //在线状态
			streamUrl: "",            //流地址
			transcod: false,          //是否转码
			username: "2231231"       //设备账号
		}]
		extraInfo: [{<!--扩展参数-->
			bundleId: " ",
			name: " ",
			value: " "
		}]
	}]
}
```



## 添加授权

#### 11.添加设备授权（接口需要描述给多个域授权多个设备

##### 平台发送passby

###### 参数

```json
{
	"layer_id": "层节点id",
	"pass_by_content": {
		"cmd": "devicePermissionAdd",
		"local": {
			"name": "本域名称"
		},
		"foreign": [{

			"name": "外域名称",

			institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
			}],
			bindChecks: ["" <!--授权信息-->],
			devices: [{<!--设备信息（同BundleVO）-->
				accessNodeUid: "",  //接入层UID
				bundleAlias: "",    //设备别名
				bundleFolderId: "",//组织机构id
				bundleId: " ",
				bundleName: "",    //设备名称
				bundleType: "",    //设备类型
				channels: [{<!--通道信息-->
					bundleId: "",
					channelId: "",
					channelName: "",
					channelStatus: "",
					channelTemplateID: //通道模板id,
					deviceModel: " "  //设备类型
				}],
				coderType: "ENCODER",  //编解码类型
				deviceAddr: {   //设备ip和地址
    				deviceIp: "",
					devicePort: 
				},
				deviceModel: " ",  //设备类型
				equipFactInfo: "域名称",
				folderId: 162,
				id: 54593,
				institution: "", //组织机构的uuid
				latitude: "",  //坐标-纬度
				location: " ", //地点
				lockStatus: "IDLE", //锁定状态
				longitude: "",  //坐标-经度
				multicastDecode: false,   //是否开启组播解码
				multicastEncode: false,   //是否开启组播编码
				multicastEncodeAddr: "",  //组播编码地址
				multicastSourceIp: "",    //组播源ip
				onlinePassword: "",       //认证密码
				onlineStatus: "ONLINE",   //在线状态
				sourceType: "SYSTEM",     //来源
				status: "ONLINE",         //在线状态
				streamUrl: "",            //流地址
				transcod: false,          //是否转码
				username: "2231231"       //设备账号
			}]
			extraInfo: [{<!--扩展参数-->
				bundleId: " ",
				name: " ",
				value: " "
			}]
		}
}
```



#### 12.添加设备授权通知

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/device/permission/add

###### 参数

```json
{

foreign: [{

			name: "外域名称", <--此处应为上一接口的本域名称-->
			institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
			}],
			bindChecks: ["" <!--授权信息-->],
			devices: [{<!--设备信息（同BundleVO）-->
				accessNodeUid: "",  //接入层UID
				bundleAlias: "",    //设备别名
				bundleFolderId: "",//组织机构id
				bundleId: " ",
				bundleName: "",    //设备名称
				bundleType: "",    //设备类型
				channels: [{<!--通道信息-->
					bundleId: "",
					channelId: "",
					channelName: "",
					channelStatus: "",
					channelTemplateID: //通道模板id,
					deviceModel: " "  //设备类型
				}],
				coderType: "ENCODER",  //编解码类型
				deviceAddr: {   //设备ip和地址
    				deviceIp: "",
					devicePort: 
				},
				deviceModel: " ",  //设备类型
				equipFactInfo: "域名称",
				folderId: 162,
				id: 54593,
				institution: "", //组织机构的uuid
				latitude: "",  //坐标-纬度
				location: " ", //地点
				lockStatus: "IDLE", //锁定状态
				longitude: "",  //坐标-经度
				multicastDecode: false,   //是否开启组播解码
				multicastEncode: false,   //是否开启组播编码
				multicastEncodeAddr: "",  //组播编码地址
				multicastSourceIp: "",    //组播源ip
				onlinePassword: "",       //认证密码
				onlineStatus: "ONLINE",   //在线状态
				sourceType: "SYSTEM",     //来源
				status: "ONLINE",         //在线状态
				streamUrl: "",            //流地址
				transcod: false,          //是否转码
				username: "2231231"       //设备账号
			}]
			extraInfo: [{<!--扩展参数-->
				bundleId: " ",
				name: " ",
				value: " "
			}]
}
```



## 取消授权

#### 13.删除设备授权（接口需要描述给多个域删除多个授权）

##### 平台发送passby

###### 参数

```json
{

	layer_id:"层节点id",
    	pass_by_content:{
    	cmd: "devicePermissionRemove",
    	local: {
        	 name: "本域名称"
         	},
    	foreign: [{
        		devices: [{
            	bundleId: ""
                		  }],
         		unBindChecks: [""],//取消的授权
         		name: "外域名称",
         		toUnbindWriteCheList: [ " "] //涉及转发授权的bundleId
           		}]
		}

}
```



#### 14.删除设备授权通知

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/device/permission/remove

###### 参数

```json
{

	foreign: [{
        		devices: [{
            	bundleId: ""
                		  }],
         		unBindChecks: [""],//取消的授权
         		name: "外域名称", <--此处应为上一接口的本域名称-->
         		toUnbindWriteCheList: [ " "] //涉及转发授权的bundleId
           		}]
		
}
```



## 设备修改组织机构、组织机构修改

#### 15.设备修改组织机构、组织机构修改

##### 平台发passby

###### 参数

```json
{
	layer_id: "层节点id",
	pass_by_content: {
		cmd: "deviceInstitutionChange",
		local: {
			name: "本域名称"
		},
		foreign: [{

          	name: "外域名称"

			institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
			}],
			devices: [{
				institution: "", //下面bundleId的组织机构
				bundleId: ""  
			}]
		}]
	}
}
```



#### 16.设备修改组织机构通知、组织机构修改

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/device/institution/change

###### 参数

```json
{

"foreign": [{

          	"name": "外域名称", <--此处应为上一接口的本域名称-->

			institutions: [{<!--组织机构信息-->
				toLdap: false,  //是否ldap文件夹
				beBvcRoot: false, //是否BVC文件夹
				sourceType: "SYSTEM", //来源
				folderIndex: 1,   //目录顺序
				parentPath: "",   //全量路径
				name: "第三级",    //名称
				id:,           //id
				uuid: "",    //uuid
				folderType: "",  //目录类型
				parentId: "",   //父目录节点
				syncStatus: "ASYNC" 
			}],
			devices: [{
				institution: "", //下面bundleId的组织机构
				bundleId: ""
			}]
		}]

}
```

### 设备上下线

#### 17.设备状态变动

##### 平台发送passby 

###### 参数

```json
{
    layer_id:"层节点id",
    pass_by_content:{
       	cmd:"deviceStatusChange",
        local:{
            name:"本域名称"
        },
        foreign:[{
            name:"外域名称",
            devices:[{
                bundleId:"设备id",
                operate:"设备状态"
            }]
        }]
    }
}
```



#### 18.设备状态变动通知

##### http调平台

###### URL

ip:8082/tetris-resource/api/thirdpart/monitor_relation/device/status/change

###### 参数

```json
{

	foreign:[{
            name:"外域名称", <--此处应为上一接口的本域名称-->
      	    devices:[{
                bundleId:"设备id",
                operate:"设备状态"
           	 }]
        }]

}
```

