<mi-frame id="page-front-role-wrapper" :menus="menus" :user="user" :groups="groups">

    <template slot="title">媒资授权</template>

    <template slot="links">
        <el-breadcrumb-item><a href="#/page-home">首页</a></el-breadcrumb-item>
        <el-breadcrumb-item>媒资授权</el-breadcrumb-item>
    </template>

    <template>
        <div class="mims-page-wrapper">
            <el-card shadow="hover">
                <el-tabs tab-position="left">
                    <el-tab-pane label="目录授权">
                        <div class="mims-page-wrapper">
                            <div class="mims-left">
                                <el-scrollbar style="height:100%;">
                                    <el-tree
                                            ref="folderTree"
                                            :props = "tree.props"
                                            :data = "tree.data"
                                            check-strictly
                                            :render-content = "renderTree"
                                            :expand-on-click-node="false"
                                            @node-click="treeNodeClick"
                                            highlight-current>
                                    </el-tree>
                                </el-scrollbar>
                            </div>
                            <div class="mims-right">
                                <div class="mims-page-wrapper" v-if="table.permission.visible">
                                    <div class="mims-page-button">
                                        <el-button size="small" type="warning" @click="handlePermissionBinding"><span class="feather-icon-user-check"></span> &nbsp;角色授权</el-button>
                                    </div>
                                    <div class="mims-page-table">
                                        <el-table
                                                :data="table.permission.rows"
                                                :row-key="permissionRowKey"
                                                style="width:100%">
                                            <el-table-column
                                                    label="角色"
                                                    prop="roleName">
                                            </el-table-column>
                                            <el-table-column
                                                    label="操作"
                                                    width="100">
                                                <template slot-scope="scope">
                                                    <el-button size="small" type="text" style="padding:0; position:relative; top:1px;" @click="handlePermissionUnbinding(scope)"><span class="feather-icon-trash-2" style="font-size:18px;"></span></el-button>
                                                </template>
                                            </el-table-column>
                                        </el-table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </el-card>
        </div>

        <!-- 授权对话框 -->
        <el-dialog
                title="授权"
                :visible.sync="dialog.permission.visible"
                width="30%"
                :before-close="handlePermissionClose">

            <div style="width:100%; height:300px; position:relative;">
                <div style="width:100%; height:360px; position:absolute; top:-30px; bottom:-30px;">
                    <el-table
                            :data="dialog.permission.rows"
                            :row-key="permissionRowKey"
                            @selection-change="handlePermissionChange"
                            height="100%"
                            style="width:100%">
                        <el-table-column
                                type="selection"
                                width="55">
                        </el-table-column>
                        <el-table-column
                                label="角色"
                                prop="name">
                        </el-table-column>
                    </el-table>
                </div>
            </div>

            <span slot="footer" class="dialog-footer">
                <el-button @click="dialog.permission.visible = false">取 消</el-button>
                <el-button type="primary" @click="handlePermissionOk" :loading="dialog.permission.loading">确 定</el-button>
            </span>
        </el-dialog>


    </template>

</mi-frame>